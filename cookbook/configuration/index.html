<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content><meta name=viewport content="width=device-width,initial-scale=1"><base href=https://jaylinski.github.io/phpspec/><title>&#8212; phpspec v6.1</title><link rel=alternate hreflang=en href=https://jaylinski.github.io/phpspec/cookbook/configuration/><link rel=icon href=https://jaylinski.github.io/phpspec/favicon.ico type=image/x-icon><style type=text/css integrity="sha256-cts4rw/maJyIcTvOOrsurOfkCBnUDGifbpTOxmz8Jd4=">*,*::before,*::after{box-sizing:border-box}ul[class],ol[class]{padding:0}body,h1,h2,h3,h4,p,ul[class],ol[class],li,figure,figcaption,blockquote,dl,dd{margin:0}body{min-height:100vh;scroll-behavior:smooth;text-rendering:optimizeSpeed;line-height:1.5}ul[class],ol[class]{list-style:none}a:not([class]){text-decoration-skip-ink:auto}img{max-width:100%;display:block}article>*+*{margin-top:1em}input,button,textarea,select{font:inherit}@media(prefers-reduced-motion:reduce){*{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important}}body{color:#414141;font-family:trebuchet ms,serif;background:#fff url(./images/bg.jpg)repeat-x;margin:0}a{color:#111}a:hover{text-decoration:none}h1,h2,h3{color:#333;font-style:italic}h1{font-size:30px;margin-bottom:.8em}h2{font-size:26px;margin-top:.8em;margin-bottom:.6em}p{font-size:15px;line-height:20px;margin-bottom:1em}pre{overflow:auto}table{border-collapse:collapse}table td,table th{border:1px solid rgba(0,0,0,.4);padding:4px 8px;text-align:left}section{max-width:840px;overflow:auto;margin:0 auto;padding:0 15px}main{margin-bottom:5em}footer{color:#777;border-top:1px solid #ccc}footer ul{list-style:none;padding:0}footer a{color:inherit}.nav-main{display:flex;justify-content:space-between;border-bottom:1px solid #c4c4c4;margin:10px 0 2em}.nav-main a{display:block;border-top:5px solid #727272;width:160px;padding:8px 0 10px;text-decoration:none;text-align:center}.nav-main a:hover{border-top-color:#fff}.nav-main ul{display:flex;list-style:none;padding:0}.nav-main .nav-active{color:#000;border-top-color:#000}.highlight pre{border-radius:5px;padding:12px 14px}.home{text-align:center;margin:4em 0}.home img{display:inline}.home h1{color:#4f4f4f;line-height:48px;margin-top:2em}.home h1 em{color:#111}.quickstart{border-top:1px solid #ccc;padding-top:2em}</style></head><body><section><nav class=nav-main><ul class=nav-item-main><li><a href=/phpspec/>main</a></li><li><a href=/phpspec/manual/introduction/>phpspec manual</a></li></ul><ul class=nav-item-github><li><a href=https://www.github.com/phpspec/phpspec target=_blank>phpspec repo</a></li><li><a href=https://www.github.com/phpspec/prophecy target=_blank>prophecy repo</a></li></ul></nav><main><h1></h1><h1 id=configuration>Configuration</h1><p>Some things in phpspec can be configured in a <code>phpspec.yml</code>,
<code>.phpspec.yml</code>, or <code>phpspec.yml.dist</code> file in the root of your project
(the directory where you run the <code>phpspec</code> command).</p><p>You can use a different config file name and path with the <code>--config</code>
option:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ bin/phpspec run --config path/to/different-phpspec.yml
</code></pre></div><p>You can use the <code>.yaml</code> extension in place of <code>.yml</code> if preferred.</p><p>You can also specify default values for config variables across all
repositories by creating the file <code>.phpspec.yml</code> in your home folder
(Unix systems). phpspec will use your personal preference for all
settings that are not defined in the project&rsquo;s configuration.</p><h2 id=psr-4>PSR-4</h2><p><strong>phpspec</strong> can try to autodetect your naming scheme by querying
Composer for autoload rules you can define in the Composer manifest. If
unsuccessful, it assumes a PSR-0 mapping of namespaces to the src and
spec directories by default. So for example running:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ bin/phpspec describe Acme/Text/Markdown
</code></pre></div><p>Will create a spec in the <code>spec/Acme/Text/MarkdownSpec.php</code> file and the
class will be created in <code>src/Acme/Text/Markdown.php</code></p><p>To use PSR-4 you configure the <code>namespace</code> and <code>psr4_prefix</code> options in
a suite to the part that should be omitted from the directory structure:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>suites</span>:
    <span style=color:#66d9ef>acme_suite</span>:
        <span style=color:#66d9ef>namespace</span>: Acme\Text
        <span style=color:#66d9ef>psr4_prefix</span>: Acme\Text
</code></pre></div><p>With this config running:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ bin/phpspec describe Acme/Text/Markdown
</code></pre></div><p>will now put the spec in <code>spec/MarkdownSpec.php</code> and the class will be
created in <code>src/Markdown.php</code>.</p><p>Alternatively, you can choose to use Composer to provide the necessary
configuration:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>composer_suite_detection</span>: <span style=color:#66d9ef>true # translates to</span>:
                               <span style=color:#75715e># - root_directory: &#39;.&#39;</span>
                               <span style=color:#75715e># - spec_prefix: spec</span>
</code></pre></div><h2 id=spec-and-source-locations>Spec and source locations</h2><p>The default locations used by <strong>phpspec</strong> for the spec files and source
files are spec and src respectively. You may find that this does not
always suit your needs. You can specify an alternative location in the
configuration file. You cannot do this at the command line as it does
not make sense for a spec or source files path to change at runtime.</p><p>You can specify alternative values depending on the namespace of the
class you are describing. In phpspec, you can group specification files
by a certain namespace in a <em>suite</em>. For each suite, you have several
configuration settings:</p><ul><li><code>namespace</code> - The namespace of the classes. Used for generating spec
files, locating them and generating code;</li><li><code>spec_prefix</code> [<strong>default</strong>: <code>spec</code>] - The namespace prefix for
specifications. The complete namespace for specifications is
<code>%spec_prefix%\%namespace%</code>;</li><li><code>src_path</code> [<strong>default</strong>: <code>src</code>] - The path to store the generated
classes. By default paths are relative to the location where
<strong>phpspec</strong> was invoked. <strong>phpspec</strong> creates the directories if they
do not exist. This does not include the namespace directories;</li><li><code>spec_path</code> [<strong>default</strong>: <code>.</code>] - The path of the specifications.
This does not include the spec prefix or namespace.</li><li><code>psr4_prefix</code> [<strong>default</strong>: <code>null</code>] - A PSR-4 prefix to use.</li></ul><p>Some examples:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>suites</span>:
    <span style=color:#66d9ef>acme_suite</span>:
        <span style=color:#66d9ef>namespace</span>: Acme\Text
        <span style=color:#66d9ef>spec_prefix</span>: acme_spec

    <span style=color:#75715e># shortcut for</span>
    <span style=color:#75715e># my_suite:</span>
    <span style=color:#75715e>#     namespace: The\Namespace</span>
    <span style=color:#66d9ef>my_suite</span>: The\Namespace
</code></pre></div><p>You may use <code>%paths.config%</code> in <code>src_path</code> and <code>spec_path</code> making paths
relative to the location of the config file.</p><p>Some examples:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>suites</span>:
    <span style=color:#66d9ef>acme_suite</span>:
        <span style=color:#66d9ef>namespace</span>: Acme\Text
        <span style=color:#66d9ef>spec_prefix</span>: acme_spec
        <span style=color:#66d9ef>src_path</span>: <span style=color:#e6db74>&#39;%paths.config%/src&#39;</span>
        <span style=color:#66d9ef>spec_path</span>: <span style=color:#e6db74>&#39;%paths.config%&#39;</span>
</code></pre></div><p><strong>phpspec</strong> will use suite settings based on the namespaces. If you have
suites with different spec directories then <code>phpspec run</code> will run the
specs from each of the directories using the relevant suite settings.</p><p>When you use <code>phpspec desc</code> <strong>phpspec</strong> creates the spec using the
matching configuration. E.g. <code>phpspec desc Acme/Text/MyClass</code> will use
the the namespace <code>acme_spec\Acme\Text\MyClass</code>.</p><p>If the namespace does not match one of the namespaces in the suites
config then <strong>phpspec</strong> uses the default settings. If you want to change
the defaults then you can add a suite without specifying the namespace.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>suites</span>:
    <span style=color:#75715e>#...</span>
    <span style=color:#66d9ef>default</span>:
        <span style=color:#66d9ef>spec_prefix</span>: acme_spec
        <span style=color:#66d9ef>spec_path</span>: acmes-specs
        <span style=color:#66d9ef>src_path</span>: acme-src
</code></pre></div><p>You can just set this suite if you wanted to override the default
settings for all namespaces. Since <strong>phpspec</strong> matches on namespaces you
cannot specify more than one set of configuration values for a null
namespace. If you do add more than one suite with a null namespace then
<strong>phpspec</strong> will use the last one defined.</p><p>Note that the default spec directory is <code>.</code>, specs are created in the
spec directory because it is the first part of the spec namespace. This
means that changing the spec_path will result in additional directories
before spec not instead of it. For example, with the config:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>suites</span>:
    <span style=color:#66d9ef>acme_suite</span>:
        <span style=color:#66d9ef>namespace</span>: Acme\Text
        <span style=color:#66d9ef>spec_prefix</span>: acme_spec
</code></pre></div><p>running:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ bin/phpspec describe Acme/Text/Markdown
</code></pre></div><p>will create the spec in the file
<code>acme_spec/spec/Acme/Text/MarkdownSpec.php</code></p><h2 id=formatter>Formatter</h2><p>You can also set another default formatter instead of <code>progress</code>. The
<code>--format</code> option of the command can override this setting. To set the
formatter, use <code>formatter.name</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>formatter.name</span>: pretty
</code></pre></div><p>The formatters available by default are:</p><ul><li>progress (default)</li><li>html/h</li><li>pretty</li><li>junit</li><li>dot</li><li>tap</li></ul><p>More formatters can be added by extensions&lt;/cookbook/extensions>.</p><h2 id=options>Options</h2><p>You can turn off code generation in your config file by setting
<code>code_generation</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>code_generation</span>: <span style=color:#66d9ef>false</span>
</code></pre></div><p>You can also set your tests to stop on failure by setting
<code>stop_on_failure</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>stop_on_failure</span>: <span style=color:#66d9ef>true</span>
</code></pre></div><p>Moreover you can turn on verbosity by setting <code>verbose</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>verbose</span>: <span style=color:#66d9ef>true</span>
</code></pre></div><p>As PHPSpec does not have a distinction between canonicals verbosity
levels (<code>-v</code>, <code>-vv</code>, <code>-vvv</code>) you cannot specify it through configuration
file. As a matter of fact running PHPSpec with any of these flags as
unix command option, will result in the same output. If you run the
command with <code>-q</code> or <code>--quite</code> the <code>verbose</code> options will be overridden.</p><h2 id=extensions>Extensions</h2><p>To register phpspec extensions, use the <code>extensions</code> option. This is an
array of extension classes:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>extensions</span>:
    - PhpSpec\Symfony2Extension\Extension
</code></pre></div><h2 id=custom-matchers>Custom matchers</h2><p>You may want to make custom matchers available in all specs. Custom
matchers can be registered by extension, but there is a simplier way:
use the <code>matchers</code> setting and provide an array of matcher classes. Each
of them must implement <code>PhpSpec\Matcher\Matcher</code> interface:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>matchers</span>:
    - Acme\Matchers\ValidJsonMatcher
    - Acme\Matchers\PositiveIntegerMatcher
</code></pre></div><h2 id=bootstrapping>Bootstrapping</h2><p>There are times when you would be required to load classes and execute
additional statements that the Composer-generated autoloader may not
provide, which is likely for a legacy project that wants to introduce
phpspec for designing new classes that may rely on some legacy
collaborators.</p><p>To load a custom bootstrap when running phpspec, use the <code>bootstrap</code>
setting:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>bootstrap</span>: path/to/different-bootstrap.php
</code></pre></div><p>This setting should be in the root of the config file (i.e. not nested
under <code>suites</code> or anything else).</p></main><nav></nav><footer><ul><li><a href=https://www.github.com/phpspec/phpspec/edit/master/docs/en/cookbook/configuration.md target=_blank>Improve this page</a></li></ul></footer></section></body></html>