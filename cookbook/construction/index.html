<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content><meta name=viewport content="width=device-width,initial-scale=1"><base href=https://jaylinski.github.io/phpspec/><title>&#8212; phpspec v6.1</title><link rel=alternate hreflang=en href=https://jaylinski.github.io/phpspec/cookbook/construction/><link rel=icon href=https://jaylinski.github.io/phpspec/favicon.ico type=image/x-icon><style type=text/css integrity="sha256-cts4rw/maJyIcTvOOrsurOfkCBnUDGifbpTOxmz8Jd4=">*,*::before,*::after{box-sizing:border-box}ul[class],ol[class]{padding:0}body,h1,h2,h3,h4,p,ul[class],ol[class],li,figure,figcaption,blockquote,dl,dd{margin:0}body{min-height:100vh;scroll-behavior:smooth;text-rendering:optimizeSpeed;line-height:1.5}ul[class],ol[class]{list-style:none}a:not([class]){text-decoration-skip-ink:auto}img{max-width:100%;display:block}article>*+*{margin-top:1em}input,button,textarea,select{font:inherit}@media(prefers-reduced-motion:reduce){*{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important}}body{color:#414141;font-family:trebuchet ms,serif;background:#fff url(./images/bg.jpg)repeat-x;margin:0}a{color:#111}a:hover{text-decoration:none}h1,h2,h3{color:#333;font-style:italic}h1{font-size:30px;margin-bottom:.8em}h2{font-size:26px;margin-top:.8em;margin-bottom:.6em}p{font-size:15px;line-height:20px;margin-bottom:1em}pre{overflow:auto}table{border-collapse:collapse}table td,table th{border:1px solid rgba(0,0,0,.4);padding:4px 8px;text-align:left}section{max-width:840px;overflow:auto;margin:0 auto;padding:0 15px}main{margin-bottom:5em}footer{color:#777;border-top:1px solid #ccc}footer ul{list-style:none;padding:0}footer a{color:inherit}.nav-main{display:flex;justify-content:space-between;border-bottom:1px solid #c4c4c4;margin:10px 0 2em}.nav-main a{display:block;border-top:5px solid #727272;width:160px;padding:8px 0 10px;text-decoration:none;text-align:center}.nav-main a:hover{border-top-color:#fff}.nav-main ul{display:flex;list-style:none;padding:0}.nav-main .nav-active{color:#000;border-top-color:#000}.highlight pre{border-radius:5px;padding:12px 14px}.home{text-align:center;margin:4em 0}.home img{display:inline}.home h1{color:#4f4f4f;line-height:48px;margin-top:2em}.home h1 em{color:#111}.quickstart{border-top:1px solid #ccc;padding-top:2em}</style></head><body><section><nav class=nav-main><ul class=nav-item-main><li><a href=/phpspec/>main</a></li><li><a href=/phpspec/manual/introduction/>phpspec manual</a></li></ul><ul class=nav-item-github><li><a href=https://www.github.com/phpspec/phpspec target=_blank>phpspec repo</a></li><li><a href=https://www.github.com/phpspec/prophecy target=_blank>prophecy repo</a></li></ul></nav><main><h1></h1><h1 id=object-construction>Object Construction</h1><p>In <strong>phpspec</strong> specs the object you are describing is not a separate
variable but is $this. So instead of writing something like:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#75715e>&lt;?php</span>

<span style=color:#66d9ef>namespace</span> <span style=color:#a6e22e>spec</span>;

<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>PhpSpec\ObjectBehavior</span>;

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MarkdownSpec</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>ObjectBehavior</span>
{
    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>it_converts_plain_text_to_html_paragraphs</span>()
    {
        $markdown <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Markdown</span>();
        $markdown<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>toHtml</span>(<span style=color:#e6db74>&#34;Hi, there&#34;</span>)<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>shouldReturn</span>(<span style=color:#e6db74>&#34;&lt;p&gt;Hi, there&lt;/p&gt;&#34;</span>);
    }
}
</code></pre></div><p>as you might with other tools, you write:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#75715e>&lt;?php</span>

<span style=color:#66d9ef>namespace</span> <span style=color:#a6e22e>spec</span>;

<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>PhpSpec\ObjectBehavior</span>;

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MarkdownSpec</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>ObjectBehavior</span>
{
    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>it_converts_plain_text_to_html_paragraphs</span>()
    {
        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>toHtml</span>(<span style=color:#e6db74>&#34;Hi, there&#34;</span>)<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>shouldReturn</span>(<span style=color:#e6db74>&#34;&lt;p&gt;Hi, there&lt;/p&gt;&#34;</span>);
    }
}
</code></pre></div><p>On consequence this means that you do not construct the object you are
describing in the examples. Instead <strong>phpspec</strong> handles the creation of
the object you are describing when you run the specs.</p><p>The default way <strong>phpspec</strong> does this is the same as <code>new Markdown()</code>.
If it does not need any values or dependencies to be passed to it then
this is fine but for many objects this will not be good enough. You can
tell <strong>phpspec</strong> how you want it to create the object though.</p><h2 id=using-the-constructor>Using the Constructor</h2><p>You can tell <strong>phpspec</strong> to pass values to the constructor when it
constructs the object:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#75715e>&lt;?php</span>

<span style=color:#66d9ef>namespace</span> <span style=color:#a6e22e>spec</span>;

<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>PhpSpec\ObjectBehavior</span>;
<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Markdown\Writer</span>;

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MarkdownSpec</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>ObjectBehavior</span>
{
    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>it_outputs_converted_text</span>(<span style=color:#a6e22e>Writer</span> $writer)
    {
        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>beConstructedWith</span>($writer);
        $writer<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>writeText</span>(<span style=color:#e6db74>&#34;&lt;p&gt;Hi, there&lt;/p&gt;&#34;</span>)<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>shouldBeCalled</span>();

        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>outputHtml</span>(<span style=color:#e6db74>&#34;Hi, there&#34;</span>);
    }
}
</code></pre></div><h2 id=using-a-factory-method>Using a Factory Method</h2><p>You may not want to use the constructor but use static factory methods
to create the class. This allows you to create it in different ways for
different use cases since you can only have a single constructor in PHP.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#75715e>&lt;?php</span>

<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Markdown\Writer</span>;

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Markdown</span>
{
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>createForWriting</span>(<span style=color:#a6e22e>Writer</span> $writer)
    {
        $markdown <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Self</span>();
        $markdown<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>writer</span> <span style=color:#f92672>=</span> $writer;

        <span style=color:#66d9ef>return</span> $markdown;
    }
}
</code></pre></div><p>You can tell <strong>phpspec</strong> this is how you want to construct the object as
follows:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#75715e>&lt;?php</span>

<span style=color:#66d9ef>namespace</span> <span style=color:#a6e22e>spec</span>;

<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>PhpSpec\ObjectBehavior</span>;
<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Markdown\Writer</span>;

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MarkdownSpec</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>ObjectBehavior</span>
{
    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>it_outputs_converted_text</span>(<span style=color:#a6e22e>Writer</span> $writer)
    {
        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>beConstructedThrough</span>(<span style=color:#e6db74>&#39;createForWriting&#39;</span>, [$writer]);
        $writer<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>writeText</span>(<span style=color:#e6db74>&#34;&lt;p&gt;Hi, there&lt;/p&gt;&#34;</span>)<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>shouldBeCalled</span>();

        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>outputHtml</span>(<span style=color:#e6db74>&#34;Hi, there&#34;</span>);
    }
}
</code></pre></div><p>Where the first argument is the method name and the second an array of
the values to pass to that method.</p><p>To be more descriptive, shorter syntaxes are available. All of the
following are equivalent:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>$this-&gt;beConstructedNamed(&#39;Bob&#39;);
$this-&gt;beConstructedThroughNamed(&#39;Bob&#39;);
$this-&gt;beConstructedThrough(&#39;Named&#39;, array(&#39;Bob&#39;));
</code></pre></div><h2 id=overriding>Overriding</h2><p>To avoid repetition you can tell <strong>phpspec</strong> how to construct the object
in let. However, you may have a single example that needs constructing
in a different way. You can do this by calling <code>beConstructedWith</code> again
in the example. The last time you call <code>beConstructedWith</code> will
determine how <strong>phpspec</strong> constructs the object:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#75715e>&lt;?php</span>

<span style=color:#66d9ef>namespace</span> <span style=color:#a6e22e>spec</span>;

<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>PhpSpec\ObjectBehavior</span>;
<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Markdown\Writer</span>;

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MarkdownSpec</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>ObjectBehavior</span>
{
    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>let</span>(<span style=color:#a6e22e>Writer</span> $writer)
    {
        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>beConstructedWith</span>($writer, <span style=color:#66d9ef>true</span>);
    }

    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>it_outputs_converted_text</span>(<span style=color:#a6e22e>Writer</span> $writer)
    {
        <span style=color:#75715e>// constructed with second argument set to true
</span><span style=color:#75715e></span>        <span style=color:#75715e>// ...
</span><span style=color:#75715e></span>    }

    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>it_does_something_if_argument_is_false</span>(<span style=color:#a6e22e>Writer</span> $writer)
    {
        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>beConstructedWith</span>($writer, <span style=color:#66d9ef>false</span>);
        <span style=color:#75715e>// constructed with second argument set to false
</span><span style=color:#75715e></span>        <span style=color:#75715e>// ...
</span><span style=color:#75715e></span>    }
}
</code></pre></div></main><nav></nav><footer><ul><li><a href=https://www.github.com/phpspec/phpspec/edit/master/docs/en/cookbook/construction.md target=_blank>Improve this page</a></li></ul></footer></section></body></html>