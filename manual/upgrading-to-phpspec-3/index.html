<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content><meta name=viewport content="width=device-width,initial-scale=1"><title>&#8212; phpspec v6.1</title><link rel=alternate hreflang=en href=http://www.phpspec.net/manual/upgrading-to-phpspec-3/><link rel=icon href=/favicon.ico type=image/x-icon><style type=text/css integrity="sha256-7hJdmgAToJMZp17gcOEPUMhzbO9hvPLSs8jqVBYO1Zc=">*,*::before,*::after{box-sizing:border-box}ul[class],ol[class]{padding:0}body,h1,h2,h3,h4,p,ul[class],ol[class],li,figure,figcaption,blockquote,dl,dd{margin:0}body{min-height:100vh;scroll-behavior:smooth;text-rendering:optimizeSpeed;line-height:1.5}ul[class],ol[class]{list-style:none}a:not([class]){text-decoration-skip-ink:auto}img{max-width:100%;display:block}article>*+*{margin-top:1em}input,button,textarea,select{font:inherit}@media(prefers-reduced-motion:reduce){*{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important}}body{color:#414141;font-family:trebuchet ms,serif;background:#fff url(/images/bg.jpg)repeat-x;margin:0}a{color:#111}a:hover{text-decoration:none}h1,h2,h3{color:#333;font-style:italic}h1{font-size:30px;margin-bottom:.8em}h2{font-size:26px;margin-top:.8em;margin-bottom:.6em}p{font-size:15px;line-height:20px;margin-bottom:1em}pre{overflow:auto}table{border-collapse:collapse}table td,table th{border:1px solid rgba(0,0,0,.4);padding:4px 8px;text-align:left}section{max-width:840px;overflow:auto;margin:0 auto;padding:0 15px}main{margin-bottom:5em}footer{color:#777;border-top:1px solid #ccc}footer ul{list-style:none;padding:0}footer a{color:inherit}.nav-main{display:flex;justify-content:space-between;border-bottom:1px solid #c4c4c4;margin:10px 0 2em}.nav-main a{display:block;border-top:5px solid #727272;width:160px;padding:8px 0 10px;text-decoration:none;text-align:center}.nav-main a:hover{border-top-color:#fff}.nav-main ul{display:flex;list-style:none;padding:0}.nav-main .nav-active{color:#000;border-top-color:#000}.highlight pre{border-radius:5px;padding:12px 14px}.home{text-align:center;margin:4em 0}.home img{display:inline}.home h1{color:#4f4f4f;line-height:48px;margin-top:2em}.home h1 em{color:#111}.quickstart{border-top:1px solid #ccc;padding-top:2em}</style></head><body><section><nav class=nav-main><ul class=nav-item-main><li><a href=/>main</a></li><li><a href=/manual/introduction/>phpspec manual</a></li></ul><ul class=nav-item-github><li><a href=https://www.github.com/phpspec/phpspec target=_blank>phpspec repo</a></li><li><a href=https://www.github.com/phpspec/prophecy target=_blank>prophecy repo</a></li></ul></nav><main><h1></h1><h1 id=upgrading-to-phpspec-3>Upgrading to phpspec 3</h1><p>Here is a guide to upgrading a test suite or an extension, based on
BC-breaking changes made in phpspec 3.</p><h2 id=upgrading-for-users>Upgrading for Users</h2><p>If you are using 3rd party <strong>phpspec</strong> extensions, you may have to
increase the version numbers for those as well.</p><p>As PHP 5.5 and below are no longer supported language versions, you will
need to upgrade to PHP 5.6 or 7.0+ to use <strong>phpspec</strong> 3.</p><p>Where you have used @param annotations for spec examples, to indicate
the required type for a collaborator, you will need to remove these and
use explicit typehinting in the method signature instead. For example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>/**
 * @param \stdClass $collaborator
 */
function it_does_something_with_a_stdclass($collaborator)
</code></pre></div><p>Change to:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>function it_does_something_with_a_stdclass(\stdClass $collaborator)
</code></pre></div><p>Extension configured in your <code>phpspec.yml</code> needs to be changed from:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>some_extension_config</span>: foo

<span style=color:#66d9ef>extensions</span>:
    - SomeExtension
    - SomeOtherExtension
</code></pre></div><p>To:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>extensions</span>:
    <span style=color:#66d9ef>SomeExtension</span>:
        <span style=color:#66d9ef>some_config</span>: foo

    <span style=color:#66d9ef>SomeOtherExtension</span>: ~
</code></pre></div><h2 id=upgrading-for-extension-authors>Upgrading for Extension Authors</h2><p>Several interfaces have been renamed in <strong>phpspec</strong> 3.0. Here is a quick
guide to changes you will need to make in your code.</p><ul><li><code>PhpSpec\Console\IO</code> is now <code>PhpSpec\Console\ConsoleIO</code></li><li><code>PhpSpec\IO\IOInterface</code> is now <code>PhpSpec\IO\IO</code></li><li><code>PhpSpec\Locator\ResourceInterface</code> is now
<code>PhpSpec\Locator\Resource</code></li><li><code>PhpSpec\Locator\ResourceLocatorInterface</code> is now
<code>PhpSpec\Locator\ResourceLocator</code></li><li><code>PhpSpec\Formatter\Presenter\PresenterInterface</code> is now
<code>PhpSpec\Formatter\Presenter\Presenter</code></li><li><code>PhpSpec\CodeGenerator\Generator\GeneratorInterface</code> is now
<code>PhpSpec\CodeGenerator\Generator\Generator</code></li><li><code>PhpSpec\Extension\ExtensionInterface</code> is now <code>PhpSpec\Extension</code></li><li><code>Phpspec\CodeAnalysis\AccessInspectorInterface</code> is now
<code>Phpspec\CodeAnalysis\AccessInspector</code></li><li><code>Phpspec\Event\EventInterface</code> is now <code>Phpspec\Event\PhpSpecEvent</code></li><li><code>PhpSpec\Formatter\Presenter\Differ\EngineInterface</code> is now
<code>PhpSpec\Formatter\Presenter\Differ\DifferEngine</code></li><li><code>PhpSpec\Matcher\MatcherInterface</code> is now <code>PhpSpec\Matcher\Matcher</code></li><li><code>PhpSpec\Matcher\MatchersProviderInterface</code> is now
<code>PhpSpec\Matcher\MatchersProvider</code></li><li><code>PhpSpec\SpecificationInterface</code> is now <code>PhpSpec\Specification</code></li><li><code>PhpSpec\Runner\Maintainer\MaintainerInterface</code> is now
<code>PhpSpec\Runner\Maintainer\Maintainer</code></li></ul><p>Some methods have a different signature:</p><ul><li><code>PhpSpec\CodeGenerator\Generator\PromptingGenerator#__construct</code>'s
third and fourth arguments are now mandatory</li><li><code>PhpSpec\Matcher\ThrowMatcher#__construct</code>'s third argument is now
mandatory</li><li><code>PhpSpec\Extension#load</code> has now an additional mandatory
<code>array $params</code> argument.</li></ul><p>A few methods have been renamed in <strong>phpspec</strong> 3.0:</p><ul><li><code>PhpSpec\ServiceContainer#set</code> is now
<code>PhpSpec\ServiceContainer#define</code></li><li><code>PhpSpec\ServiceContainer#setShared</code> is now
<code>PhpSpec\ServiceContainer#define</code></li></ul><p>Other things to bear in mind:</p><ul><li><code>PhpSpec\ServiceContainer</code> is now an interface (available
implementation: <code>PhpSpec\ServiceContainer\IndexedServiceContainer</code>)</li><li><code>PhpSpec\ServiceContainer\ServiceContainer#getByPrefix</code> has been
replaced by <code>PhpSpec\ServiceContainer\ServiceContainer#getByTag</code>.
Tags can be set via
<code>PhpSpec\ServiceContainer\ServiceContainer#define</code>'s third argument</li></ul></main><nav></nav><footer><ul><li><a href=https://www.github.com/phpspec/phpspec/edit/master/docs/en/manual/upgrading-to-phpspec-3.md target=_blank>Improve this page</a></li></ul></footer></section></body></html>