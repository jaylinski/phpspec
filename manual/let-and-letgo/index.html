<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content><meta name=viewport content="width=device-width,initial-scale=1"><title>&#8212; phpspec v6.1</title><link rel=alternate hreflang=en href=https://jaylinski.github.io/phpspec/manual/let-and-letgo/><link rel=icon href=/favicon.ico type=image/x-icon><style type=text/css integrity="sha256-7hJdmgAToJMZp17gcOEPUMhzbO9hvPLSs8jqVBYO1Zc=">*,*::before,*::after{box-sizing:border-box}ul[class],ol[class]{padding:0}body,h1,h2,h3,h4,p,ul[class],ol[class],li,figure,figcaption,blockquote,dl,dd{margin:0}body{min-height:100vh;scroll-behavior:smooth;text-rendering:optimizeSpeed;line-height:1.5}ul[class],ol[class]{list-style:none}a:not([class]){text-decoration-skip-ink:auto}img{max-width:100%;display:block}article>*+*{margin-top:1em}input,button,textarea,select{font:inherit}@media(prefers-reduced-motion:reduce){*{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important}}body{color:#414141;font-family:trebuchet ms,serif;background:#fff url(/images/bg.jpg)repeat-x;margin:0}a{color:#111}a:hover{text-decoration:none}h1,h2,h3{color:#333;font-style:italic}h1{font-size:30px;margin-bottom:.8em}h2{font-size:26px;margin-top:.8em;margin-bottom:.6em}p{font-size:15px;line-height:20px;margin-bottom:1em}pre{overflow:auto}table{border-collapse:collapse}table td,table th{border:1px solid rgba(0,0,0,.4);padding:4px 8px;text-align:left}section{max-width:840px;overflow:auto;margin:0 auto;padding:0 15px}main{margin-bottom:5em}footer{color:#777;border-top:1px solid #ccc}footer ul{list-style:none;padding:0}footer a{color:inherit}.nav-main{display:flex;justify-content:space-between;border-bottom:1px solid #c4c4c4;margin:10px 0 2em}.nav-main a{display:block;border-top:5px solid #727272;width:160px;padding:8px 0 10px;text-decoration:none;text-align:center}.nav-main a:hover{border-top-color:#fff}.nav-main ul{display:flex;list-style:none;padding:0}.nav-main .nav-active{color:#000;border-top-color:#000}.highlight pre{border-radius:5px;padding:12px 14px}.home{text-align:center;margin:4em 0}.home img{display:inline}.home h1{color:#4f4f4f;line-height:48px;margin-top:2em}.home h1 em{color:#111}.quickstart{border-top:1px solid #ccc;padding-top:2em}</style></head><body><section><nav class=nav-main><ul class=nav-item-main><li><a href=/phpspec/>main</a></li><li><a href=/phpspec/manual/introduction/>phpspec manual</a></li></ul><ul class=nav-item-github><li><a href=https://www.github.com/phpspec/phpspec target=_blank>phpspec repo</a></li><li><a href=https://www.github.com/phpspec/prophecy target=_blank>prophecy repo</a></li></ul></nav><main><h1></h1><h1 id=let-and-let-go>Let and Let Go</h1><p>If you need to pass the object into the constructor instead of a method
then you can do it like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#75715e>&lt;?php</span>

<span style=color:#66d9ef>namespace</span> <span style=color:#a6e22e>spec</span>;

<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>PhpSpec\ObjectBehavior</span>;
<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Markdown\Writer</span>;

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MarkdownSpec</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>ObjectBehavior</span>
{
    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>it_outputs_converted_text</span>(<span style=color:#a6e22e>Writer</span> $writer)
    {
        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>beConstructedWith</span>($writer);
        $writer<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>writeText</span>(<span style=color:#e6db74>&#34;&lt;p&gt;Hi, there&lt;/p&gt;&#34;</span>)<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>shouldBeCalled</span>();

        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>outputHtml</span>(<span style=color:#e6db74>&#34;Hi, there&#34;</span>);
    }
}
</code></pre></div><p>If you have many examples then writing this in each example will get
tiresome. You can instead move this to a let method. The let method gets
run before each example so each time the parser gets constructed with a
fresh mock object.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#75715e>&lt;?php</span>

<span style=color:#66d9ef>namespace</span> <span style=color:#a6e22e>spec</span>;

<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>PhpSpec\ObjectBehavior</span>;
<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Markdown\Writer</span>;

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MarkdownSpec</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>ObjectBehavior</span>
{
    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>let</span>(<span style=color:#a6e22e>Writer</span> $writer)
    {
        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>beConstructedWith</span>($writer);
    }
}
</code></pre></div><p>There is also a letGo method which runs after each example if you need
to clean up after the examples.</p><p>It looks like you will now have difficulty getting hold of the instance
of the mock object in the examples. This is easier to deal with than it
looks though. Providing you use the same variable name for both,
<strong>phpspec</strong> will inject the same instance into the let method and the
example. The following will work:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#75715e>&lt;?php</span>

<span style=color:#66d9ef>namespace</span> <span style=color:#a6e22e>spec</span>;

<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>PhpSpec\ObjectBehavior</span>;
<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Markdown\Writer</span>;

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MarkdownSpec</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>ObjectBehavior</span>
{
    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>let</span>(<span style=color:#a6e22e>Writer</span> $writer)
    {
        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>beConstructedWith</span>($writer);
    }

    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>it_outputs_converted_text</span>($writer)
    {
        $writer<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>writeText</span>(<span style=color:#e6db74>&#34;&lt;p&gt;Hi, there&lt;/p&gt;&#34;</span>)<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>shouldBeCalled</span>();

        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>outputHtml</span>(<span style=color:#e6db74>&#34;Hi, there&#34;</span>);
    }
}
</code></pre></div></main><nav></nav><footer><ul><li><a href=https://www.github.com/phpspec/phpspec/edit/master/docs/en/manual/let-and-letgo.md target=_blank>Improve this page</a></li></ul></footer></section></body></html>